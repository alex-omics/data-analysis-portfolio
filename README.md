# gastric-cancer-microarray-analysis
Differential expression analysis of an Affymetrix gastric cancer dataset [GSE33335](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE33335).
Includes outlier detection, statistical testing, principal component analysis, linear discriminant analysis, and discriminant gene mapping.

## Repo Structure

├── data/                                           # Raw data files (e.g., platform annotation)
│ └── GPL5175.soft.gz.zip
├── scripts/                                        # R analysis scripts
│ └── gastric_cancer_microarray_analysis.R
├── results/                                        # Output data (discriminant genes)
│ └── top_and_bottom_5_genes.png
├── plots/                                          # Figures generated from the analysis
│ ├── average_correlation.png
│ ├── correlation_matrix.png
│ ├── cv_vs_mean.png
│ ├── dual_filter_results.png
│ ├── hierarchical_clustering.png
│ ├── linear_discriminant.png
│ ├── pca.png
│ └── scree_plot.png
└── README.md                                       # Project overview

## Project Goals

- Download, parse, and filter raw expression data from a public database
- Practice quality control by testing for outlier samples
- Filter genes by significant expression alteration (p-value) and magnitude of change (log2 fold-change)
- Conduct dimensionality reduction and clustering to group samples by state
- Conduct linear discriminant analysis to identify top/bottom discriminant genes by state
- Interpret results in biological context

## Analysis Steps

1. **Data Loading**
   - Import raw expression files, unzip and examine tabular data

2. **Quality Control**
   - Hierarchical clustering, correlation matrix, average correlation, and CV vs. mean plots to identify outlier samples
   - Removal of outlier samples
  
3. **Significance and Fold-Change Filtration**
   - Student's t-test between normal and cancer groups
   - Bonferroni-corrected significance threshold
   - |log2(FC)| > 1 for biologically meaningful up/downregulation
   - Return intersection between p-filtered and FC-filtered sets of probes

4. **Dimensionality Reduction**
   - Principal Component Analysis (PCA)
   - Scree plot
   - Linear Discriminant Analysis (LDA)
   - Discriminant function plot
  
5. **Discriminant Gene Ranking & Mapping**
   - Identify top and bottom 5 probes by LDA coefficients
   - Map probe IDs to gene names

Script is located at [`scripts/gastric_cancer_microarray_analysis.R`](scripts/gastric_cancer_microarray_analysis.R)

## Visualization

Plots generated by the main script include:

- **average_correlation.png**: Per-sample average gene expression correlation  
- **correlation_matrix.png**: Pairwise Pearson correlation (heatmap)
- **cv_vs_mean.png**: Variance-to-mean scatterplot  
- **scree_plot.png**: PCA variance attributable to each component 
- **pca.png**: Principal component projection by sample class
- **hierarchical_clustering.png**: Sample clustering dendrogram  
- **linear_discriminant.png**: LDA projection  
- **dual_filter_results.png**: Histogram of probes meeting p and FC thresholds

## Requirements

This analysis was written in **R 4.4.0** and requires the following packages:

- **CRAN**: `corrplot`, `MASS`
- **Bioconductor**: `GEOquery`, `limma`

To install these packages, run the following command in R:

```r
install.packages(c("corrplot", "MASS"))
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install(c("GEOquery", "limma"))
```

## Author

Alex Arvanitis
alexarvani83@gmail.com
GitHub: alex-omics

